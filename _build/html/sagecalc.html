

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>SageMath as a Calculator &#8212; SDSU Sage Tutorial v1.1</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Programming in SageMath" href="sageprog.html" />
    <link rel="prev" title="About this tutorial" href="about.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="sageprog.html" title="Programming in SageMath"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="about.html" title="About this tutorial"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SDSU Sage Tutorial v1.1</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sagemath-as-a-calculator">
<span id="index-0"></span><span id="id1"></span><h1>SageMath as a Calculator<a class="headerlink" href="#sagemath-as-a-calculator" title="Permalink to this headline">¶</a></h1>
<p>This part of the tutorial examines commands that  allow you to use SageMath much like a graphing calculator.  The chapter on  arithmetic and functions and the chapter on solving equations and inequalities serve as a foundation for the rest of the material.   The chapters on plotting, statistics and  calculus are independent of each other, although plotting may be useful to read next since plotting graphs is so is useful in calculus and in statistics.</p>
<div class="section" id="arithmetic-and-functions">
<span id="index-1"></span><span id="id2"></span><h2>Arithmetic and Functions<a class="headerlink" href="#arithmetic-and-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="basic-arithmetic">
<span id="index-2"></span><span id="id3"></span><h3>Basic Arithmetic<a class="headerlink" href="#basic-arithmetic" title="Permalink to this headline">¶</a></h3>
<p id="index-3">The basic arithmetic operators are <code class="docutils literal"><span class="pre">+</span></code>, <code class="docutils literal"><span class="pre">-</span></code>, <code class="docutils literal"><span class="pre">*</span></code>, and <code class="docutils literal"><span class="pre">/</span></code> for addition, subtraction, multiplication and division, while <code class="docutils literal"><span class="pre">^</span></code> is used for exponents.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="mi">1</span><span class="o">+</span><span class="mi">1</span>
<span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">103</span><span class="o">-</span><span class="mi">101</span>
<span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">7</span><span class="o">*</span><span class="mi">9</span>
<span class="mi">63</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">7337</span><span class="o">/</span><span class="mi">11</span>
<span class="mi">667</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">11</span><span class="o">/</span><span class="mi">4</span>
<span class="mi">11</span><span class="o">/</span><span class="mi">4</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">2</span><span class="o">^</span><span class="mi">5</span>
<span class="mi">32</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">-</span></code> symbol in front of a number indicates that it is negative.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="o">-</span><span class="mi">6</span>
<span class="o">-</span><span class="mi">6</span>
<span class="n">sage</span><span class="p">:</span> <span class="o">-</span><span class="mi">11</span><span class="o">+</span><span class="mi">9</span>
<span class="o">-</span><span class="mi">2</span>
</pre></div>
</div>
<p id="index-4">As we would expect, SageMath adheres to the standard order of operations,
PEMDAS (parenthesis, exponents, multiplication, division, addition,
subtraction).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="mi">4</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="mi">33</span>
<span class="n">sage</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="mi">65</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="mi">4</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="mi">128</span>
<span class="n">sage</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="o">^</span><span class="mi">2</span>
<span class="o">-</span><span class="mi">9</span>
<span class="n">sage</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="mi">9</span>
</pre></div>
</div>
<p>When dividing two integers, there is a subtlety; whether SageMath will return a fraction or it’s decimal approximation. Unlike most graphing calculators, SageMath will attempt to be as <em>precise</em> as possible and will return the fraction unless told otherwise. One way to tell SageMath that we <em>want</em> the decimal approximation is to include a decimal in the expression itself.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="mi">11</span><span class="o">/</span><span class="mf">4.0</span>
<span class="mf">2.75000000000000</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">11</span><span class="o">/</span><span class="mf">4.</span>
<span class="mf">2.75000000000000</span>
<span class="n">sage</span><span class="p">:</span> <span class="mf">11.0</span><span class="o">/</span><span class="mi">4</span>
<span class="mf">2.75000000000000</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">11</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="mf">1.</span>
<span class="mf">2.75000000000000</span>
</pre></div>
</div>
<p><strong>Exercises:</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li>Divide <span class="math">28</span> by <span class="math">2</span> raised to the 5th power as a  rational number, then get it’s decimal approximation.</li>
<li>Compute a decimal approximation of <span class="math">\sqrt{2}</span></li>
<li>Use sage to compute <code class="docutils literal"><span class="pre">(-9)^(1/2)</span></code>. Describe the output.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="integer-division-and-factoring">
<span id="division-and-factoring"></span><span id="index-5"></span><h3>Integer Division and Factoring<a class="headerlink" href="#integer-division-and-factoring" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>You should be familiar with “<a class="reference internal" href="#basic-arithmetic"><span class="std std-ref">Basic Arithmetic</span></a>”</div></blockquote>
<p>Sometimes when we divide, the division operator doesn’t give us all of the information that we want. Often we would like to not just know what the reduced fraction is, or even it’s decimal approximation, but rather the unique <em>quotient</em> and the <em>remainder</em> that are the consequence of the division.</p>
<p id="index-6">To calculate the quotient we use the <code class="docutils literal"><span class="pre">//</span></code> operator and the <code class="docutils literal"><span class="pre">%</span></code> operator is used for the remainder.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="mi">14</span> <span class="o">//</span> <span class="mi">4</span>
<span class="mi">3</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">14</span> <span class="o">%</span> <span class="mi">4</span>
<span class="mi">2</span>
</pre></div>
</div>
<p id="index-7">If we want both the quotient and the remainder all at once, we use the <a class="reference external" href="https://docs.python.org/3/library/functions.html#divmod" title="(in Python v3.7)"><code class="xref py py-func docutils literal"><span class="pre">divmod()</span></code></a> command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="nb">divmod</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p id="index-8">Recall that <span class="math">b</span> <em>divides</em> <span class="math">a</span> if <span class="math">0</span> is the remainder when we divide the two integers. The integers in SageMath have a built-in command ( or ‘method’ ) which allows us to check whether one integer divides another.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="mf">3.</span><span class="n">divides</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="kc">True</span>
<span class="n">sage</span><span class="p">:</span> <span class="mf">5.</span><span class="n">divides</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="kc">False</span>
</pre></div>
</div>
<p id="index-9">A related command is the <code class="xref py py-meth docutils literal"><span class="pre">divisors()</span></code> method. This method returns
a list of all positive divisors of the integer specified.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="mf">12.</span><span class="n">divisors</span><span class="p">()</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="mf">101.</span><span class="n">divisors</span><span class="p">()</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">]</span>
</pre></div>
</div>
<p id="index-10">When the divisors of an integer are only <span class="math">1</span> and itself then we say that the number is <em>prime</em>. To check if a number is prime in sage, we use it’s <code class="xref py py-meth docutils literal"><span class="pre">is_prime()</span></code> method.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">19</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="kc">True</span>
<span class="n">sage</span><span class="p">:</span> <span class="mf">153.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="kc">False</span>
</pre></div>
</div>
<p>Notice the parentheses around <code class="docutils literal"><span class="pre">2^19</span> <span class="pre">-1</span></code> in the first example. They are important to the order of operations in SageMath, and if they are not included then SageMath will compute something very different than we intended. Try evaluating <code class="docutils literal"><span class="pre">2^19-1.is_prime()</span></code> and notice the result.  When in doubt, the judicious use of <em>parenthesis</em> is encouraged.</p>
<p id="index-11">We use the <code class="xref py py-meth docutils literal"><span class="pre">factor()</span></code> method to compute the <em>prime factorization</em> of an integer.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="mf">62.</span><span class="n">factor</span><span class="p">()</span>
<span class="mi">2</span> <span class="o">*</span> <span class="mi">31</span>
<span class="n">sage</span><span class="p">:</span> <span class="mf">63.</span><span class="n">factor</span><span class="p">()</span>
<span class="mi">3</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">7</span>
</pre></div>
</div>
<p id="index-12">If we are interested in simply knowing which prime numbers divide an integer, we may use it’s <code class="xref py py-meth docutils literal"><span class="pre">prime_divisors()</span></code> (or <code class="xref py py-meth docutils literal"><span class="pre">prime_factors()</span></code>) method.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="mf">24.</span><span class="n">prime_divisors</span><span class="p">()</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="mf">63.</span><span class="n">prime_factors</span><span class="p">()</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
<p id="index-13">Finally, we have the <em>greatest common divisor</em> and <em>least common multiple</em> of a pair of integers. A <em>common divisor</em> of two integers is any integer which is a divisor of each, whereas a <em>common multiple</em> is a number which both integers divide.</p>
<p>The greatest common divisor (gcd), not too surprisingly, is the largest of all of these common divisors. The <code class="xref py py-func docutils literal"><span class="pre">gcd()</span></code> command is used to calculate this divisor.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">63</span><span class="p">)</span>
<span class="mi">7</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span>
<span class="mi">1</span>
</pre></div>
</div>
<p>Notice that if two integers share no common divisors, then their gcd will be <span class="math">1</span>.</p>
<p>The least common multiple is the smallest integer which both integers divide. The <code class="xref py py-func docutils literal"><span class="pre">lcm()</span></code> command is used to calculate the least common multiple.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">lcm</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">20</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">lcm</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>
<span class="mi">42</span>
</pre></div>
</div>
<p><strong>Exercises:</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li>Find the quotient and remainder when diving <span class="math">98</span> into <span class="math">956</span>.</li>
<li>Use SageMath to verify that the quotient and remainder computed above are correct.</li>
<li>Use SageMath to determine if <span class="math">3</span> divides <span class="math">234878</span>.</li>
<li>Compute the list of divisors for each of the integers <span class="math">134,\ 491,\ 422</span> and <span class="math">1002</span>.</li>
<li>Which of the integers above are <em>prime</em>?</li>
<li>Calculate <span class="math">\mathrm{gcd}(a,b)</span>,  <span class="math">\mathrm{lcm}(a,b)</span> and <span class="math">a \cdot b</span> for the pairs of integers <span class="math">\left(2,5\right),\ \left(4,10\right)</span> and <span class="math">\left(18,51\right)</span>. How do the gcd, lcm and the product of the numbers relate?</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="standard-functions-and-constants">
<span id="basic-functions-and-constants"></span><span id="index-14"></span><h3>Standard Functions and Constants<a class="headerlink" href="#standard-functions-and-constants" title="Permalink to this headline">¶</a></h3>
<p>SageMath includes nearly all of the standard functions that one encounters
when studying mathematics. In this section, we shall cover some of the
most commonly used functions: the <em>maximum</em>, <em>minimum</em>, <em>floor</em>,
<em>ceiling</em>, <em>trigonometric</em>, <em>exponential</em>, and <em>logarithm</em> functions.
We will also see many of the standard mathematical constants; such as <em>Euler’s constant</em> (<span class="math">e</span>), <span class="math">\pi</span>, and <em>the golden ratio</em> (<span class="math">\phi</span>).</p>
<p id="index-15">The <a class="reference external" href="https://docs.python.org/3/library/functions.html#max" title="(in Python v3.7)"><code class="xref py py-func docutils literal"><span class="pre">max()</span></code></a> and <a class="reference external" href="https://docs.python.org/3/library/functions.html#min" title="(in Python v3.7)"><code class="xref py py-func docutils literal"><span class="pre">min()</span></code></a> commands return the largest and smallest of a set of numbers.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="mi">8</span>
<span class="n">sage</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
</pre></div>
</div>
<p>We may input any number of arguments into the max and min functions.</p>
<p id="index-16">In SageMath we use the <a class="reference external" href="https://docs.python.org/3/library/functions.html#abs" title="(in Python v3.7)"><code class="xref py py-func docutils literal"><span class="pre">abs()</span></code></a> command to compute the <em>absolute value</em> of
a real number.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="mi">10</span>
<span class="n">sage</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="mi">4</span>
</pre></div>
</div>
<p id="index-17">The <code class="xref py py-func docutils literal"><span class="pre">floor()</span></code> command rounds a number down to the nearest integer, while <code class="xref py py-func docutils literal"><span class="pre">ceil()</span></code> rounds up.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">floor</span><span class="p">(</span><span class="mf">2.1</span><span class="p">)</span>
<span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ceil</span><span class="p">(</span><span class="mf">2.1</span><span class="p">)</span>
<span class="mi">3</span>
</pre></div>
</div>
<p>We need to be very careful while using <code class="xref py py-func docutils literal"><span class="pre">floor()</span></code> and <code class="xref py py-func docutils literal"><span class="pre">ceil()</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">floor</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mf">2.1</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="mi">9</span>
</pre></div>
</div>
<p>This is clearly not correct: <span class="math">\lfloor 1/(2.1-2)\rfloor = \lfloor 1/.1 \rfloor = \lfloor 10 \rfloor = 10</span>. So what happened?</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mf">2.1</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="mf">9.99999999999999</span>
</pre></div>
</div>
<p>Computers store real numbers in <em>binary</em>, while we are accustomed to using the decimal representation. The <span class="math">2.1</span> in decimal notation is quite simple and short, but when converted to binary it is <span class="math">10.0001\overline{1}=10.0001100110011\ldots</span></p>
<p>Since computers cannot store an infinite number of digits, this gets rounded off somewhere, resulting in the slight error we saw. In SageMath, however, <em>rational numbers</em> (fractions) are exact, so we will never see this rounding error.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">floor</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">21</span><span class="o">/</span><span class="mi">10</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="mi">10</span>
</pre></div>
</div>
<p>Due to this, it is often a good idea to use rational numbers whenever possible instead of decimals, particularly if a high level of precision is required.</p>
<p id="index-18">The <code class="xref py py-func docutils literal"><span class="pre">sqrt()</span></code> command calculates the <em>square root</em> of a real number. As we have seen earlier with fractions, if we want a decimal approximation we can get this by giving a decimal number as the input.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="mf">1.73205080756888</span>
</pre></div>
</div>
<p>To compute other roots, we use a rational exponent. SageMath can compute any rational power. If either the exponent or the base is a decimal then the output will be a decimal.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="mi">3</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="p">(</span><span class="mf">3.0</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="mf">1.73205080756888</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">8</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">8</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">2</span>
</pre></div>
</div>
<p id="index-19">SageMath also has available all of the standard trigonometric functions: for sine and cosine we use <code class="xref py py-func docutils literal"><span class="pre">sin()</span></code> and <code class="xref py py-func docutils literal"><span class="pre">cos()</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sin</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="mf">0.841470984807897</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
<span class="mf">0.0707372016677029</span>
</pre></div>
</div>
<p>Again we see the same behavior that we saw with <code class="xref py py-func docutils literal"><span class="pre">sqrt()</span></code>, SageMath will give us an exact answer.  You might think that since there is no way to simplify <code class="docutils literal"><span class="pre">sin(1)</span></code>,  why bother?  Well, some expressions involving sine can indeed be simplified. For example, an important identity from geometry is <span class="math">\sin(\pi/3 ) = \sqrt{3}/2</span>. SageMath has a built-in symbolic <span class="math">\pi</span>, and understands this identity:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">pi</span>
<span class="n">pi</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p id="index-20">When we type <code class="xref py py-obj docutils literal"><span class="pre">pi</span></code> in SageMath we are dealing exactly with <span class="math">\pi</span>, not some numerical approximation. However, we can call for a numerical approximation using the <code class="xref py py-meth docutils literal"><span class="pre">n()</span></code> method:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
<span class="mf">3.14159265358979</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="mi">0</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">())</span>
<span class="mf">1.22464679914735e-16</span>
</pre></div>
</div>
<p>We see that when using the symbolic <code class="xref py py-obj docutils literal"><span class="pre">pi</span></code>, SageMath returns the exact result. However,  when we use the approximation we get an approximation back. <code class="docutils literal"><span class="pre">e-15</span></code> is a shorthand for <span class="math">10^{-15}</span> and the number <code class="docutils literal"><span class="pre">1.22464679914735e-16</span></code> should be zero, but there are errors introduced by the approximation. Here are a few examples of using the symbolic, precise <span class="math">\pi</span> vs the numerical approximation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">()</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
<span class="mf">0.500000000000000</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">()</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="mf">0.707106781186547</span>
</pre></div>
</div>
<p>Continuing on with the theme, there are some lesser known special angles for which the value of sine or cosine can be cleverly simplified.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sin</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">12</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p id="index-21">Other trigonometric functions, the inverse trigonometric functions and hyperbolic functions are also available.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">arctan</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="mf">0.785398163397448</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sinh</span><span class="p">(</span><span class="mf">9.0</span><span class="p">)</span>
<span class="mf">4051.54190208279</span>
</pre></div>
</div>
<p id="index-22">Similar to <code class="xref py py-obj docutils literal"><span class="pre">pi</span></code> SageMath has a built-in symbolic constant for the number <span class="math">e</span>, the base of the natural logarithm.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">e</span>
<span class="n">e</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
<span class="mf">2.71828182845905</span>
</pre></div>
</div>
<p id="index-23">While some might be familiar with using <code class="docutils literal"><span class="pre">ln(x)</span></code> for natural log and <code class="docutils literal"><span class="pre">log(x)</span></code> to represent logarithm base <span class="math">10</span>, in SageMath both represent logarithm
base <span class="math">e</span>.  We may specify a different base as a second argument to the command: to compute <span class="math">\log_{b}(x)</span> in SageMath we use the command <code class="docutils literal"><span class="pre">log(x,b)</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">ln</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="mi">1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="mi">1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
<span class="mf">2.30258509299405</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="mi">2</span>
</pre></div>
</div>
<p id="index-24">Exponentiation base <span class="math">e</span> can done using both the <code class="xref py py-func docutils literal"><span class="pre">exp()</span></code> function and by raising the symbolic constant <code class="docutils literal"><span class="pre">e</span></code> to a specified power.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">e</span><span class="o">^</span><span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="mf">7.38905609893065</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">pi</span><span class="p">))</span>
<span class="n">pi</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="mi">2</span>
</pre></div>
</div>
<p><strong>Exercises:</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li>Compute the floor and ceiling of <span class="math">2.75</span>.</li>
<li>Compute the logarithm base <span class="math">e</span> of  <span class="math">1/1000000</span>, compute the logarithm base 10 of  <span class="math">1/1000000</span>, then compute the ratio.  What should the answer be?</li>
<li>Compute the logarithm base 2 of <span class="math">64</span>.</li>
<li>Compare <span class="math">e^{i \pi}</span> with a numerical approximation of it using <code class="docutils literal"><span class="pre">pi.n()</span></code>.</li>
<li>Compute <span class="math">\sin(\pi/2)</span>, <span class="math">\cot(0)</span> and <span class="math">\csc(\pi/16)</span>.</li>
</ol>
</div></blockquote>
</div>
</div>
<div class="section" id="solving-equations-and-inequalities">
<span id="solving-equations-inequalities"></span><span id="index-25"></span><h2>Solving Equations and Inequalities<a class="headerlink" href="#solving-equations-and-inequalities" title="Permalink to this headline">¶</a></h2>
<div class="section" id="solving-for-x">
<span id="solving-x"></span><span id="index-26"></span><h3>Solving for x<a class="headerlink" href="#solving-for-x" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>You should be familiar with “<a class="reference internal" href="#basic-arithmetic"><span class="std std-ref">Basic Arithmetic</span></a>” and “<a class="reference internal" href="#basic-functions-and-constants"><span class="std std-ref">Standard Functions and Constants</span></a>”</div></blockquote>
<p id="index-27">In SageMath, equations and inequalities are defined using the <em>operators</em> <code class="docutils literal"><span class="pre">==</span></code>, <code class="docutils literal"><span class="pre">&lt;=</span></code>, and <code class="docutils literal"><span class="pre">&gt;=</span></code> and will return either <code class="docutils literal"><span class="pre">True</span></code>, <code class="docutils literal"><span class="pre">False</span></code>, or, if there is a variable, just the equation/inequality.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="mi">9</span> <span class="o">==</span> <span class="mi">9</span>
<span class="kc">True</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">9</span> <span class="o">&lt;=</span> <span class="mi">10</span>
<span class="kc">True</span>
<span class="n">sage</span><span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">5</span>
<span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">5</span>
</pre></div>
</div>
<p id="index-28">To solve an equation or an inequality we use using the, aptly named, <code class="xref py py-func docutils literal"><span class="pre">solve()</span></code> command. For the moment, we will only solve for <span class="math">x</span>.  The section on variables below explains how to use other variables.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">5</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span><span class="mi">5</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">&gt;=</span> <span class="mi">17</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="p">[[</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">11</span><span class="p">]]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">[[</span><span class="n">x</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="p">)]]</span>
</pre></div>
</div>
<p>Equations can have multiple solutions, SageMath returns all solutions found as a list.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span>  <span class="o">==</span> <span class="mi">6</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="p">]</span>
</pre></div>
</div>
<p>The solution set of certain inequalities consists of the union and intersection of open intervals.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span> <span class="p">)</span>
<span class="p">[[</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">]]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span> <span class="p">)</span>
<span class="p">[[</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">]]</span>
</pre></div>
</div>
<p>The <code class="xref py py-func docutils literal"><span class="pre">solve()</span></code> command will attempt to express the solution of an
equation without the use of floating point numbers. If this cannot be
done, it will return the solution in a symbolic form.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="p">]</span>
</pre></div>
</div>
<p id="index-29">To find a numeric approximation of the solution we can use the
<code class="xref py py-func docutils literal"><span class="pre">find_root()</span></code> command. Which requires both the expression and a closed
interval on which to search for a solution.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">find_root</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="mf">0.0</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">find_root</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">pi</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="mf">3.9269908169872414</span>
</pre></div>
</div>
<p>This command will only return one solution on the specified interval, if one exists. It will not find the complete solution set over the entire real numbers.
To find a complete set of solutions, the reader must use <code class="xref py py-func docutils literal"><span class="pre">find_root()</span></code> repeatedly over cleverly selected intervals. Sadly, at this point, SageMath cannot do all of the thinking for us. This feature is not planned until SageMath 10.</p>
</div>
<div class="section" id="declaring-variables">
<span id="declare-variables"></span><span id="index-30"></span><h3>Declaring Variables<a class="headerlink" href="#declaring-variables" title="Permalink to this headline">¶</a></h3>
<p id="index-31">In the previous section we only solved equations in one variable, and we always used <span class="math">x</span>. When a session is started, SageMath creates one symbolic variable, <span class="math">x</span>, and it can be used to solve equations.  If you want to use  an additional symbolic variable, you have to <em>declare it</em>  using the <code class="xref py py-func docutils literal"><span class="pre">var()</span></code> command. The name of a symbolic variable can be a letter, or a combination of letters and numbers:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;y z t&quot;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">rho</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;phi theta rho&quot;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;x1 x2&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Variable names cannot contain spaces, for example “square root”
is not a valid variable name, whereas “square_root” is.</p>
</div>
<p>Attempting to use a symbolic variable before it has been declared will result in a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NameError" title="(in Python v3.7)"><code class="xref py py-exc docutils literal"><span class="pre">NameError</span></code></a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">u</span>
<span class="o">...</span>
<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;u&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span> <span class="p">(</span><span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;u&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<p id="index-32">We can un-declare a symbolic variable, like the variable <code class="docutils literal"><span class="pre">phi</span></code> defined above,  by using the <code class="xref py py-func docutils literal"><span class="pre">restore()</span></code>
command.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">restore</span><span class="p">(</span><span class="s1">&#39;phi&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">phi</span>
<span class="o">...</span>
<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;phi&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
</div>
<div class="section" id="solving-equations-with-several-variables">
<span id="solve-several-variables"></span><span id="index-33"></span><h3>Solving Equations with Several Variables<a class="headerlink" href="#solving-equations-with-several-variables" title="Permalink to this headline">¶</a></h3>
<p>Small systems of linear equations can be also solved using  <code class="xref py py-func docutils literal"><span class="pre">solve()</span></code>, provided that all the symbolic variables have been declared.
The equations must be input as a list, followed by the symbolic variables.  The result may be  either a unique solution, infinitely many solutions, or no solutions at all.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">],</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="p">[[</span><span class="n">x</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">),</span> <span class="n">y</span> <span class="o">==</span> <span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">5</span><span class="p">)]]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="p">[</span>  <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">==</span> <span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="p">[[</span><span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">r1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span> <span class="o">==</span> <span class="n">r1</span><span class="p">]]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="p">[</span>  <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="p">[]</span>
</pre></div>
</div>
<p>In the second equation above, <code class="docutils literal"><span class="pre">r1</span></code> signifies that there is a free
variable which parametrizes the solution set. When there is more than
one free variable, SageMath enumerates them <code class="docutils literal"><span class="pre">r1,r2,...,</span> <span class="pre">rk</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">([</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">z</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">z</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">9</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">z</span> <span class="o">==</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
<span class="p">[[</span><span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">r1</span> <span class="o">-</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span> <span class="o">==</span> <span class="n">r2</span><span class="p">,</span> <span class="n">z</span> <span class="o">==</span> <span class="n">r1</span><span class="p">]]</span>
</pre></div>
</div>
<p><code class="xref py py-func docutils literal"><span class="pre">solve()</span></code> can be very slow for large systems of equations. For these systems, it is best to use the linear algebra functions as they are quite efficient.</p>
<p>Solving inequalities in several variables can lead to complicated expressions, since the regions they define are complicated. In the example below, SageMath’s solution is a list containing the point of interesection of the lines, then  two rays, then the region between the two rays.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">([</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="o">&gt;=</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span> <span class="o">&lt;=</span><span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="p">[[</span><span class="n">x</span> <span class="o">==</span> <span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">y</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)]]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">([</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">&lt;</span> <span class="mi">4</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="p">[[</span><span class="o">-</span><span class="n">y</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">]]</span>
</pre></div>
</div>
<p><strong>Exercises:</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li>Find all of the solutions to the equation <span class="math">x^3 - x = 7x^2 - 7</span>.</li>
<li>Find the complete solution set for the inequality <span class="math">\left\vert t - 7 \right\vert \geq 3</span>.</li>
<li>Find all <span class="math">x</span> and <span class="math">y</span> that satisfy both <span class="math">2x + y = 17</span> and <span class="math">x - 3y = -16</span>.</li>
<li>Use <code class="xref py py-func docutils literal"><span class="pre">find_root()</span></code> to find a solution of the equation <span class="math">e^{x} = \cos(x)</span> on the interval <span class="math">\left[-\pi/2, 0\right]</span>.</li>
<li>Change the command above so that <code class="xref py py-func docutils literal"><span class="pre">find_root()</span></code> finds the other solution in the same interval.</li>
</ol>
</div></blockquote>
</div>
</div>
<div class="section" id="calculus">
<span id="index-34"></span><span id="id4"></span><h2>Calculus<a class="headerlink" href="#calculus" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>You should be familiar with <a class="reference internal" href="#basic-arithmetic"><span class="std std-ref">Basic Arithmetic</span></a>, <a class="reference internal" href="#basic-functions-and-constants"><span class="std std-ref">Standard Functions and Constants</span></a>, and <a class="reference internal" href="#declare-variables"><span class="std std-ref">Declaring Variables</span></a></div></blockquote>
<p id="index-35">SageMath has many commands that are useful for the study of differential and integral calculus. We will begin our investigation of these command by defining a few functions that we will use throughout the chapter.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">f</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="n">x</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="n">x</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">g</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">h</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">h</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>SageMath uses <code class="docutils literal"><span class="pre">x</span> <span class="pre">|--&gt;</span></code> to tell you that the expression returned is actually a function and not just a number or string. This means that we can <em>evaluate</em> these expressions just like you would expect of any function.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">g</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>
<span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">^</span><span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">h</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="mi">2</span><span class="o">/</span><span class="mi">5</span>
</pre></div>
</div>
<p>With these functions defined, we will look at how we can use SageMath to compute the <em>limit</em> of these functions.</p>
<div class="section" id="limits">
<span id="index-36"></span><span id="id5"></span><h3>Limits<a class="headerlink" href="#limits" title="Permalink to this headline">¶</a></h3>
<p id="index-37">The limit of <span class="math">f(x) = xe^{x}</span> as <span class="math">x \rightarrow 1</span> is computed in SageMath by entering the following command into SageMath:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">limit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e</span>
</pre></div>
</div>
<p>We can do the same with <span class="math">g(x)</span>. To evaluate the limit of <span class="math">g(x) = x^{2} \cos(2x)</span> as <span class="math">x \rightarrow 2</span> we enter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">limit</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="mi">4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>The functions <span class="math">f(x)</span> and <span class="math">g(x)</span> aren’t all that exciting as far as limits are concerned since they are both <em>continuous</em> for all real numbers. But <span class="math">h(x)</span> has a discontinuity at <span class="math">x=4</span>, so to investigate what is happening near this discontinuity we will look at the limit of <span class="math">h(x)</span> as <span class="math">x \rightarrow 4</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">limit</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">Infinity</span>
</pre></div>
</div>
<p>Now this is an example of why we have to be a little careful when using computer algebra systems. The limit above is not exactly correct. See the graph of <span class="math">h(x)</span> near this discontinuity below.</p>
<a class="reference internal image-reference" href="_images/asymptote.png"><img alt="&quot;Rational Function with vertical asymptote x=4&quot;" src="_images/asymptote.png" style="width: 400px; height: 300px;" /></a>
<p id="index-38">What we have when <span class="math">x=4</span> is a <em>vertical asymptote</em> with the function tending toward <em>positive</em> infinity if <span class="math">x</span> is larger than <span class="math">4</span> and <em>negative</em> infinity from when <span class="math">x</span> less than <span class="math">4</span>. We can takes these <em>directional</em> limits using SageMath to confirm this by supplying the extra <em>dir</em> argument.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">limit</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="n">Infinity</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">limit</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="o">-</span><span class="n">Infinity</span>
</pre></div>
</div>
</div>
<div class="section" id="derivatives">
<span id="index-39"></span><span id="id6"></span><h3>Derivatives<a class="headerlink" href="#derivatives" title="Permalink to this headline">¶</a></h3>
<p id="index-40">The next thing we are going to do is use SageMath to compute the <em>derivatives</em> of the functions that we defined earlier. For example, to compute <span class="math">f^{\prime}(x)</span>, <span class="math">g^{\prime}(x)</span>, and <span class="math">h^{\prime}(x)</span> we will use the <code class="xref py py-func docutils literal"><span class="pre">derivative()</span></code> command.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">fp</span>  <span class="o">=</span>  <span class="n">derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">fp</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="n">x</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="n">x</span> <span class="o">+</span> <span class="n">e</span><span class="o">^</span><span class="n">x</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">gp</span> <span class="o">=</span>  <span class="n">derivative</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">gp</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">hp</span>  <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">hp</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
<p id="index-41">The first argument is the function which you would like to differentiate and the second argument is the variable with which you would like to differentiate with respect to. For example, if I were to supply a different variable, SageMath will hold <span class="math">x</span> constant and take the derivative with respect to that variable.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="mi">0</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">derivative</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="mi">0</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">derivative</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="mi">0</span>
</pre></div>
</div>
<p>The <code class="xref py py-func docutils literal"><span class="pre">derivative()</span></code> command returns another function that can be evaluated like any other function.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">fp</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="mi">11</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="mi">10</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">gp</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="o">-</span><span class="n">pi</span>
<span class="n">sage</span><span class="p">:</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">hp</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
<p id="index-42">With the <em>derivative function</em> computed, we can then find the <em>critical points</em> using the <code class="xref py py-func docutils literal"><span class="pre">solve()</span></code> command.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="n">fp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="o">^</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="n">hp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">3</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solve</span><span class="p">(</span> <span class="n">gp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)]</span>
</pre></div>
</div>
<p id="index-43">Constructing the line <em>tangent</em> to our functions at the point <span class="math">\left(x, f\left(x\right)\right)</span> is an important computation which is easily done in SageMath. For example, the following command will compute the line tangent to <span class="math">f(x)</span> at the point <span class="math">\left(0,f(0)\right)</span>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">T_f</span> <span class="o">=</span> <span class="n">fp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T_f</span>
<span class="n">x</span>
</pre></div>
</div>
<p>The same can be done for <span class="math">g(x)</span> and <span class="math">h(x)</span>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">T_g</span> <span class="o">=</span> <span class="n">gp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">+</span> <span class="n">g</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T_g</span>
<span class="mi">0</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T_h</span> <span class="o">=</span> <span class="n">hp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">+</span> <span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T_h</span>
<span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="integrals">
<span id="index-44"></span><span id="id7"></span><h3>Integrals<a class="headerlink" href="#integrals" title="Permalink to this headline">¶</a></h3>
<p id="index-45">SageMath has the facility to compute both <em>definite</em> and <em>indefinite</em> integral for many common functions. We will begin by computing the <em>indefinite</em> integral, otherwise known as the <em>anti-derivative</em>,  for each of the functions that we defined earlier. This will be done by using the <code class="xref py py-func docutils literal"><span class="pre">integral()</span></code> command which has arguments that are similar to <code class="xref py py-func docutils literal"><span class="pre">derivative()</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="n">x</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">integral</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">integral</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">18</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>The function that is returned is only <em>one</em> of the many anti-derivatives that exist for each of these functions.
The others differ by a constant. We can verify that we have indeed computed the <em>anti-derivative</em> by taking the derivative of our indefinite integrals.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">derivative</span><span class="p">(</span><span class="n">integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="n">x</span> <span class="o">+</span> <span class="n">e</span><span class="o">^</span><span class="n">x</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">f</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="n">x</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="n">x</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">derivative</span><span class="p">(</span><span class="n">integral</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">derivative</span><span class="p">(</span><span class="n">integral</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">18</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span>
</pre></div>
</div>
<p>Wait, none of these look right. But a little algebra, and the use of a trig-identity or two in the case of <code class="docutils literal"><span class="pre">1/2*(2*x^2</span> <span class="pre">-</span> <span class="pre">1)*cos(2*x)</span> <span class="pre">+</span> <span class="pre">1/2*cos(2*x)</span></code>, you will see that they are indeed the same.</p>
<p>It should also be noted that there are some functions which are continuous and yet there doesn’t exist a <em>closed form</em> integral. A common example is <span class="math">e^{-x^2}</span> which forms the basis for the <em>normal distribution</em> which is ubiquitous throughout statistics.  The antiderivative for <span class="math">er^{-x^2}</span> is commonly called  <span class="math">\mathrm{erf}</span>, otherwise known as the <em>error function</em>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">integral</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also compute the <em>definite</em> integral for the functions that we defined earlier. This is done by specifying the <em>limits of integration</em> as addition arguments.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="mi">1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">integral</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">integral</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">|--&gt;</span> <span class="mi">18</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">18</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">11</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
<p>In each case above, SageMath returns a <em>function</em> as its result. Each of these functions is a constant function, which is what we would expect. As it was pointed out earlier, SageMath will return the expression that retains the most precision and will not use decimals unless told to. A quick way to tell SageMath that an approximation is desired is wrap the <code class="xref py py-func docutils literal"><span class="pre">integrate()</span></code> command with <code class="xref py py-func docutils literal"><span class="pre">n()</span></code>, the numerical approximation command.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">n</span><span class="p">(</span><span class="n">integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="mf">1.00000000000000</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">n</span><span class="p">(</span><span class="n">integral</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="mf">0.0192509384328492</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">n</span><span class="p">(</span><span class="n">integral</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="mf">0.321722695867944</span>
</pre></div>
</div>
</div>
<div class="section" id="taylor-series-expansion">
<span id="taylor"></span><span id="index-46"></span><h3>Taylor Series Expansion<a class="headerlink" href="#taylor-series-expansion" title="Permalink to this headline">¶</a></h3>
<p>Another interesting feature of SageMath is the possibility of computing <a class="reference external" href="https://en.wikipedia.org/wiki/Taylor_series">Taylor Series</a> expansions around a point. At first we show how to expand around 0, also called Mclaurin series. Let us give an example with the function <span class="math">g(x) = \cos(x)</span>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">g</span>
<span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">g_taylor</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The first argument in g.taylor() is the independent variable of our function, the second argument is the point around which we are expanding, and the third argument is the order of accuracy of the expansion, i.e. where we truncate it. The above case was a pretty simple one, but sometimes you might have to compute a much harder Taylor expansion. For instance, let us try to expand the function <span class="math">f(x) = \exp(x^{2})\sin(x-5)</span> around the point <span class="math">\x=2</span> up to order 3.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">^</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">5</span><span class="p">);</span> <span class="n">f</span>
<span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">f_taylor</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">f_taylor</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">467</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2130</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">24</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">155</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="n">e</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Now the outcome of this computation might be a bit convoluted to visualize, therefore, another interesting feature of SageMath is the possibility of printing the outcome in <a class="reference external" href="https://www.latex-project.org/">Latex</a> format, which is much nicer to the eye.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="nb">print</span><span class="p">;</span> <span class="n">show</span><span class="p">(</span><span class="n">f_taylor</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Taylor_tex.png"><img alt="Using SageMath at the command line." src="_images/Taylor_tex.png" style="width: 800px; height: 525px;" /></a>
<p><strong>Exercises:</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li>Use SageMath to compute the following limits:<ol class="loweralpha">
<li><span class="math">\lim_{x \rightarrow 2} \frac{x^{2} + 2 \, x - 8}{x-2}</span></li>
<li><span class="math">\lim_{x \rightarrow (\pi/2)^{+}} \sec(x)</span></li>
<li><span class="math">\lim_{x \rightarrow (\pi/2)^{-}} \sec(x)</span></li>
</ol>
</li>
<li>Use SageMath to compute the following <em>derivatives</em> with respect to the specified variables:<ol class="loweralpha">
<li><span class="math">\frac{d}{dx}\left[ x^{2}e^{3x}\cos(2x) \right]</span></li>
<li><span class="math">\frac{d}{dt}\left[\frac{t^2 + 1}{t-2}\right]</span> <em>(remember to define ``t``)</em></li>
<li><span class="math">\frac{d}{dy}\left[ x\cos(x)\right]</span></li>
</ol>
</li>
<li>Use SageMath to compute the following integrals:<ol class="loweralpha">
<li><span class="math">\int \frac{x+1}{x^2 + 2x + 1}dx</span></li>
<li><span class="math">\int_{-\pi/4}^{\pi/4} \sec(x) dx</span></li>
<li><span class="math">\int x e^{-x^{2}} dx</span></li>
</ol>
</li>
<li>Use SageMath to compute the Taylor series expansion of the following functions:<ol class="loweralpha">
<li><span class="math">\sin(x)*\cos(x)</span> around <span class="math">x=0</span>, order 3</li>
<li><span class="math">\(x-2)*\ln(x/2)</span> around <span class="math">x=1</span>, order 4</li>
<li><span class="math">\tan(x+5) - \exp(x^2)</span>, around <span class="math">x=\pi</span>, order 5</li>
</ol>
</li>
</ol>
</div></blockquote>
</div>
</div>
<div class="section" id="statistics">
<span id="basic-stats"></span><span id="index-47"></span><h2>Statistics<a class="headerlink" href="#statistics" title="Permalink to this headline">¶</a></h2>
<p>You should be familiar with <a class="reference internal" href="#basic-arithmetic"><span class="std std-ref">Basic Arithmetic</span></a></p>
<p>In this section we will discuss the use of some of the basic descriptive statistic functions availble for use in SageMath.</p>
<p id="index-48">To demonstrate their usage we will first generate a pseudo-random list
of integers from 0 to 100 to describe. The <code class="xref py py-func docutils literal"><span class="pre">random()</span></code> function generates a random number from <span class="math">[0,1)</span>, so we will use a trick to generate integers in this specific range. Note, by the nature of random number generation your list of numbers will be different.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>  <span class="nb">int</span><span class="p">(</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">)</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">1</span> <span class="o">..</span> <span class="mi">20</span> <span class="p">]</span> <span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">data</span>
<span class="p">[</span><span class="mi">78</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span>
<span class="mi">30</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
</pre></div>
</div>
<p id="index-49">We can compute the mean, median, mode, variance, and standard
deviation of this data.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="mi">254</span><span class="o">/</span><span class="mi">5</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="mi">45</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">mode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span>
<span class="mi">34</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">94</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">variance</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="mi">83326</span><span class="o">/</span><span class="mi">95</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sqrt</span><span class="p">(</span><span class="mi">83326</span><span class="o">/</span><span class="mi">95</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that both the standard deviation and variance are computed in their unbiased forms. It we want to bias these measures then you can use the <code class="docutils literal"><span class="pre">bias=True</span></code> option.</p>
<p id="index-50">We can also compute a rolling, or moving, average of the data with the <code class="xref py py-func docutils literal"><span class="pre">moving_average()</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">moving_average</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="p">[</span><span class="mi">177</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">73</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">197</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">267</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">205</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">169</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>
<span class="mi">133</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">79</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">76</span><span class="p">,</span><span class="mi">233</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">277</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">77</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">moving_average</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="mi">523</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mi">223</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">437</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span><span class="mi">262</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">252</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">278</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span>
<span class="mi">272</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">529</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span><span class="mi">533</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span><span class="mi">97</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">493</span><span class="o">/</span><span class="mi">10</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">moving_average</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="p">[</span><span class="mi">254</span><span class="o">/</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Exercises:</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li>Use SageMath to generate a list of 20 random integers.</li>
<li>The heights of eight students, measured in inches, are <span class="math">71,\ 73,\  59,\ 62,\ 65,\ 61,\ 73,\ 61</span>. Find the <em>average</em>, <em>median</em> and <em>mode</em> of the heights of these students.</li>
<li>Using the same data, compute the <em>standard deviation</em> and <em>variance</em> of the sampled heights.</li>
<li>Find the <em>range</em> of the heights. (<em>Hint: use the</em> <a class="reference external" href="https://docs.python.org/3/library/functions.html#max" title="(in Python v3.7)"><code class="xref py py-func docutils literal"><span class="pre">max()</span></code></a> <em>and</em> <a class="reference external" href="https://docs.python.org/3/library/functions.html#min" title="(in Python v3.7)"><code class="xref py py-func docutils literal"><span class="pre">min()</span></code></a> <em>commands</em>)</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="plotting">
<span id="basic-plotting"></span><span id="index-51"></span><h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="d-graphics">
<span id="d-plotting-and-graphics"></span><h3>2D Graphics<a class="headerlink" href="#d-graphics" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>You should be familiar with <a class="reference internal" href="#basic-functions-and-constants"><span class="std std-ref">Standard Functions and Constants</span></a> and <a class="reference internal" href="#solving-equations-inequalities"><span class="std std-ref">Solving Equations and Inequalities</span></a></div></blockquote>
<p>SageMath has many ways for us to visualize the mathematics that we are working with. In this section we will quickly get you up to speed with some of the basic commands used when plotting functions and working with graphics.</p>
<p id="index-52">To produce a basic plot of <span class="math">\sin(x)</span> from <span class="math">x=-\frac{\pi}{2}</span> to <span class="math">x=\frac{\pi}{2}</span> we will use the <code class="xref py py-func docutils literal"><span class="pre">plot()</span></code> command.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/sin_plot.png"><img alt="Plot of sin(x) from x = -pi/2 to pi/2" src="_images/sin_plot.png" style="width: 400px; height: 300px;" /></a>
<p id="index-53">By default, the plot created will be quite plain. To add axis labels
and make our plotted line purple, we can alter the plot attribute by
adding the <code class="docutils literal"><span class="pre">axes_labels</span></code> and <code class="docutils literal"><span class="pre">color</span></code> options.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;sin(x)&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/sin_plot_purple_labels.png"><img alt="Plot of sin with purple line and basic axis labels" src="_images/sin_plot_purple_labels.png" style="width: 400px; height: 300px;" /></a>
<p>The <code class="docutils literal"><span class="pre">color</span></code> option accepts string color designations ( ‘purple’, ‘green’, ‘red’, ‘black’, etc…), an RGB triple such as (.25,.10,1), or an HTML-style hex triple such as #ff00aa.</p>
<p id="index-54">We can change the style of line, whether it is solid, dashed, and it’s thickness by using the <code class="docutils literal"><span class="pre">linestyle</span></code> and the <code class="docutils literal"><span class="pre">thickness</span></code> options.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/sin_plot_dashed_thick.png"><img alt="Plot of sin(x) using a thick dashed blue line" src="_images/sin_plot_dashed_thick.png" style="width: 400px; height: 300px;" /></a>
<p id="index-55">We can display the graphs of two functions on the same axes by adding the plots together.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">q</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">r</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">q</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/sin_cos_plot.png"><img alt="Plot of sin(x) and cos(x) on the same axes" src="_images/sin_cos_plot.png" style="width: 400px; height: 300px;" /></a>
<p>To tie together our plotting commands with some material we have
learned earlier, let’s use the <code class="xref py py-func docutils literal"><span class="pre">find_root()</span></code> command to find the
point where <span class="math">\sin(x)</span> and <span class="math">\cos(x)</span> intersect. We will then add this point to the graph and label it.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">find_root</span><span class="p">(</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="p">)</span>
<span class="mf">0.78539816339744839</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">P</span> <span class="o">=</span> <span class="n">point</span><span class="p">(</span> <span class="p">[(</span><span class="mf">0.78539816339744839</span><span class="p">,</span> <span class="n">sin</span><span class="p">(</span><span class="mf">0.78539816339744839</span><span class="p">))]</span> <span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">text</span><span class="p">(</span><span class="s2">&quot;(0.79,0.71)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.78539816339744839</span><span class="p">,</span> <span class="n">sin</span><span class="p">(</span><span class="mf">0.78539816339744839</span><span class="p">)</span> <span class="o">+</span> <span class="o">.</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">s</span> <span class="o">=</span> <span class="n">P</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="n">T</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/sin_cos_point_plot.png"><img alt="sin(x) and cos(x) on same axes with point of intersection labeled" src="_images/sin_cos_point_plot.png" style="width: 400px; height: 300px;" /></a>
<p>SageMath handles many of the details of producing “nice” looking plots in
a way that is transparent to the user. However there are times in
which SageMath will produce a plot which isn’t quite what we were
expecting.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span><span class="mi">2</span> <span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/rat_func_with_asymptotes.png"><img alt="Plot of rational function with asymptotes" src="_images/rat_func_with_asymptotes.png" style="width: 400px; height: 300px;" /></a>
<p>The vertical asymptotes of this rational function cause SageMath to adjust the aspect ratio of the plot to display the rather large <span class="math">y</span> values near <span class="math">x=-1</span> and <span class="math">x=2</span>. This obfuscates most of the features of this function in a way that we may have not intended. To remedy this we can explicitly adjust the vertical and horizontal limits of our plot</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">xmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/rat_func_with_asymptotes_adj.png"><img alt="Plot of rational function with asymptote with vertical limits adjusted" src="_images/rat_func_with_asymptotes_adj.png" style="width: 400px; height: 300px;" /></a>
<p>This, in the author’s opinion, displays the features of this particular function in a much more pleasing fashion.</p>
<p id="index-56">SageMath can handle parametric plots with the <code class="xref py py-func docutils literal"><span class="pre">parametric_plot()</span></code> command. The following is a simple circle of radius 3.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">parametric_plot</span><span class="p">(</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/parametric_circle.png"><img alt="Circle of radius 3 centered at the origin" src="_images/parametric_circle.png" style="width: 400px; height: 300px;" /></a>
<p id="index-57">The default choice of aspect ratio makes the plot above decidedly
“un-circle like”. We can adjust this by using the <code class="docutils literal"><span class="pre">aspect_ratio</span></code>
option.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/parametric_circle_fixed.png"><img alt="Circle of radius 3 with 1/1 aspect ratio" src="_images/parametric_circle_fixed.png" style="width: 400px; height: 300px;" /></a>
<p>The different plotting commands accept many of the same options as
plot. The following generates the Lissajous Curve <span class="math">L(3,2)</span> with
a thick red dashed line.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">parametric_plot</span><span class="p">(</span> <span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)],</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/L3,2-red.png"><img alt="Lissajous Curve L(3,2)" src="_images/L3,2-red.png" style="width: 400px; height: 300px;" /></a>
<p id="index-58">Polar plots can be done using the <code class="xref py py-func docutils literal"><span class="pre">polar_plot()</span></code> command.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;theta&quot;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">r</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">polar_plot</span><span class="p">((</span><span class="n">r</span><span class="p">(</span><span class="n">theta</span><span class="p">)),</span> <span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/8petal-polar.png"><img alt="Eight Petal 'folium' curve" src="_images/8petal-polar.png" style="width: 400px; height: 300px;" /></a>
<p>And finally, SageMath can do the plots for functions that are implicitly defined. For example, to display all points <span class="math">(x,y)</span> that satisfy the equation <span class="math">4x^2y - 3y = x^3 -1</span>, we enter the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">implicit_plot</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">==</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/implicit_plot1.png"><img alt="Example of plotting a curve defined implicitly" src="_images/implicit_plot1.png" style="width: 400px; height: 300px;" /></a>
<p id="index-59">As we transition from 2D-plotting to 3D-plotting, it is worthwhile to briefly mention <a class="reference external" href="https://en.wikipedia.org/wiki/Contour_line">countour lines</a>. If you are familiar with some basic notions of Multivariable Calculus, you know that a contour line is a curve where a function of two variables holds constant value. Their plots are often useful to gather information about the function itself. Contour lines find use in a variety of fields, from <a class="reference external" href="https://gisgeography.com/contour-lines-topographic-map/">cartography</a> to <a class="reference external" href="https://en.wikipedia.org/wiki/Contour_line#Meteorology">meteorology</a>. Here we pick a trivial example for pedagogical purposes: an hyperbola.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;x,y&quot;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">contour</span> <span class="o">=</span> <span class="n">contour_plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">contour</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/contour.png"><img alt="Example of plotting contour lines" src="_images/contour.png" style="width: 400px; height: 300px;" /></a>
<p>Now, the above picture is not really pleasant to the eye and not very informative either. Thankfully we can customize our contour plot to make it look nicer and clearer.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;x,y&quot;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">contour</span> <span class="o">=</span> <span class="n">contour_plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cool&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">contour</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/contour_fill_false.png"><img alt="Example of plotting contour lines" src="_images/contour_fill_false.png" style="width: 400px; height: 300px;" /></a>
<p>Now, we have printed the values of the function at each contour line and the plot is much clearer. You are free to check for other custom colors <a class="reference external" href="https://matplotlib.org/examples/color/colormaps_reference.html">here</a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">**</span><span class="n">Exercises</span><span class="p">:</span><span class="o">**</span>
</pre></div>
</div>
<blockquote>
<div><ol class="arabic simple">
<li>Plot the graph of <span class="math">y = \sin\left(\pi x - \pi  \right)</span> for <span class="math">-1 \leq x \leq 1</span> using a thick red line.</li>
<li>Plot the graph of <span class="math">\cos\left(\pi x - \pi \right)</span> on the same interval using a thick blue line.</li>
<li>Plot the two graphs above on the same set of axes.</li>
<li>Plot the graph of <span class="math">y = 1/x</span> for <span class="math">-1 \leq x \leq 1</span> adjusting the range so that only <span class="math">-10 \leq y \leq 10</span>.</li>
<li>Use the commands in this section to produce the following image:</li>
</ol>
<a class="reference internal image-reference" href="_images/circles.png"><img alt="Two circles of radius 3." src="_images/circles.png" style="width: 400px; height: 300px;" /></a>
</div></blockquote>
</div>
<div class="section" id="id8">
<span id="id9"></span><h3>3D Graphics<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p id="index-60">Producing 3D plots can be done using the <code class="xref py py-func docutils literal"><span class="pre">plot3d()</span></code> command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;x y&quot;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">plot3d</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/3d-plot-1.png"><img alt="Snapshot of 3D plot" src="_images/3d-plot-1.png" style="width: 500px; height: 500px;" /></a>
<p>SageMath handles 3d plotting a bit differently than what we have seen thus far. It uses a program named jmol to generate interactive plots. So instead of just a static picture we will see either a window like pictured above or, if you are using SageMath’s notebook interface, a java applet in your browser’s window.</p>
<p>One nice thing about the way that SageMath does this is that you can rotate your plot by just clicking on the surface and dragging it in the direction in which you would like for it to rotate. Zooming in/out can also be done by using your mouse’s wheel button (or two-finger vertical swipe on a mac). Once you have rotated and zoomed the plot to your liking, you can save the plot as a file. Do this by right-clicking anywhere in the window/applet and selecting save, then png-image as pictured below</p>
<a class="reference internal image-reference" href="_images/3d-plot-2.png"><img alt="Saving a 3d plot to a file in Jmol" src="_images/3d-plot-2.png" style="width: 500px; height: 500px;" /></a>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are running SageMath on windows or on sagenb.org that your file will be saved either in your VMware virtual machine or on sagenb.org.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">

	  <h3><a href="index.html">Topics</a></h3>
	  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About this tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SageMath as a Calculator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#arithmetic-and-functions">Arithmetic and Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-arithmetic">Basic Arithmetic</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integer-division-and-factoring">Integer Division and Factoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="#standard-functions-and-constants">Standard Functions and Constants</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#solving-equations-and-inequalities">Solving Equations and Inequalities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solving-for-x">Solving for x</a></li>
<li class="toctree-l3"><a class="reference internal" href="#declaring-variables">Declaring Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#solving-equations-with-several-variables">Solving Equations with Several Variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#calculus">Calculus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#limits">Limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#derivatives">Derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrals">Integrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#taylor-series-expansion">Taylor Series Expansion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#statistics">Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotting">Plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#d-graphics">2D Graphics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">3D Graphics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sageprog.html">Programming in SageMath</a></li>
<li class="toctree-l1"><a class="reference internal" href="mathstruct.html">Mathematical Structures</a></li>
</ul>

	  <h3>This Page</h3>
	  <ul class="this-page-menu">
	    <li><a href="_sources/sagecalc.rst.txt"
	    rel="nofollow">Show Source</a></li>
	  </ul>
	<div id="searchbox" style="display: none">
	  <h3>Quick search</h3>
	  <form class="search" action="search.html" method="get">
	  <input type="text" name="q" size="18" />
	  <input type="submit" value="Go" />
	  <input type="hidden" name="check_keywords" value="yes" />
	  <input type="hidden" name="area" value="default" />
	  </form>
	</div>
	<script type="text/javascript">$('#searchbox').show(0);</script>
       </div>
    </div>

      <div class="clearer"></div>
    </div> 
<div class="related"> &nbsp; </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2011, Michael O&#39;Sullivan,  David Monarres.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>